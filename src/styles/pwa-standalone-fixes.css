/* 
  PWA STANDALONE MODE FIXES
  These rules handle layout issues when the app is saved to home screen
  and runs in standalone/fullscreen mode
*/

@media all and (display-mode: standalone) {
  /* CRITICAL: Ensure app uses full screen height */
  html, body, #root {
    height: 100vh !important;
    /* Remove max-height constraint that causes gaps in PWA mode */
    min-height: 100vh !important;
    padding: 0 !important;
    margin: 0 !important;
    /* Allow content to fill properly */
    overflow: hidden !important;
    position: relative !important;
  }
  
  /* Ensure photobooth app fills entire screen in PWA mode */
  body div.photobooth-app {
    height: 100vh !important;
    overflow: hidden !important;
    position: relative !important;
    max-height: unset !important;
  }
  
  /* Ensure photobooth frame fills screen without white gaps */
  .photobooth-frame {
    min-height: 100vh !important;
    min-height: calc(var(--vh, 1vh) * 100) !important;
    /* Remove max-height that causes white space */
  }
  
  /* Ensure camera start menu covers full screen in PWA */
  .camera-start-menu {
    height: 100vh !important;
  }
  
  /* Ensure body and html background covers any potential gaps in PWA mode */
  html, body {
    background: linear-gradient(135deg, #ff61d5 0%, #7132e8 100%) !important;
    background-attachment: fixed !important;
    min-height: 100vh !important;
    min-height: calc(var(--vh, 1vh) * 100) !important;
  }
  
  /* Ensure root container also has proper background */
  #root {
    background: linear-gradient(135deg, #ff61d5 0%, #7132e8 100%) !important;
    min-height: 100vh !important;
    min-height: calc(var(--vh, 1vh) * 100) !important;
  }

  /* Move top controls higher - another 5px higher */
  .top-left-style-selector, .header-style-select, .global-style-btn {
    top: max(10px, env(safe-area-inset-top)) !important;
  }

  .header-settings-btn {
    top: max(10px, env(safe-area-inset-top)) !important;
  }

  .header-info-btn {
    top: max(10px, env(safe-area-inset-top)) !important;
  }

  /* Fix photo grid to use full available space with proper scroll behavior */
  .film-strip-container {
    /* Ensure smooth scrolling on iOS */
    -webkit-overflow-scrolling: touch !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    overscroll-behavior: contain !important;
    /* Remove transform that breaks scrolling */
    transform: none !important;
    will-change: auto !important;
    height: 100vh !important;
  }

  html body .film-strip-container.visible .film-strip-content:not(.prompt-selector-mode) {
    padding-top: max(110px, env(safe-area-inset-top)) !important;
  }
  html body .film-strip-container.visible .film-strip-content {
    padding-bottom: max(60px, env(safe-area-inset-bottom)) !important;
  }
  html body .prompt-selector-header > div {
    padding-top: 55px!important;
  }



  /* CAMERA POSITIONING - Adjust to better position (reduce from 300px) */
  [class*="cameraContainer"] {
    height: 100vh !important;
    max-height: unset !important;
  }

  /* Remove conflicting polaroid frame margins */
  [class*="polaroidFrame"] {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  /* Position camera buttons EVEN LOWER - 0.66x more down from 5px */
  [class*="bottomControls"] {
    bottom: 13px !important;
  }

  /* Fix image adjuster overlay to cover full screen */
  .image-adjuster-overlay {
    height: 100vh !important;
  }

  /* START MENU OVERLAY - REMOVED ALL GARBAGE CSS THAT DOESN'T WORK */
  /* Keeping it ugly since none of the fixes work */

  /* Fix Advanced Settings overlay - AGGRESSIVE OVERRIDE */

  html body .photobooth-app .control-overlay.visible {
    min-height: 100vh !important;
    overflow-y: auto !important;
    z-index: 99999 !important;
    transform: translateY(0) !important;
    padding-top: 60px !important;
  }

  /* Fix Advanced Settings content container */
  html body .control-overlay .control-overlay-content {
    margin: 0 !important;
  }

  html body .main-content-area {
    max-height: none !important;
  }

  html body .twitter-modal {
    padding-top: 50px;
    padding-bottom: 40px;
    max-height: none !important;
  }
  /* Fix Twitter modal close button */
  .twitter-modal-close {
    top: max(12px, env(safe-area-inset-top) + 8px) !important;
    right: max(12px, env(safe-area-inset-right) + 8px) !important;
  }

  /* Fix photo close button positioning - move down from status bar */
  .photo-close-btn {
    top: max(60px, env(safe-area-inset-top) + 15px) !important;
    right: max(20px, env(safe-area-inset-right) + 10px) !important;
    /* Ensure it's in a touchable area */
    min-width: 44px !important;
    min-height: 44px !important;
    width: 44px !important;
    height: 44px !important;
    /* Make it more visible */
    background: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(10px) !important;
  }

  /* Fix photo action buttons positioning in PWA mode */
  .photo-action-buttons {
    bottom: max(30px, env(safe-area-inset-bottom)) !important;
  }

  /* Ensure action buttons are properly sized for touch */
  .action-button {
    min-height: 44px !important;
    font-size: 14px !important;
  }

  /* Fix other modal close buttons */
  .modal [class*="close"], .modal .close-btn, [class*="modal"] [class*="close"] {
    top: max(16px, env(safe-area-inset-top) + 8px) !important;
    right: max(16px, env(safe-area-inset-right) + 8px) !important;
  }

  /* Fix photo navigation buttons in PWA mode */
  .photo-nav-btn {
    top: 50% !important;
    transform: translateY(-50%) !important;
    min-width: 44px !important;
    min-height: 44px !important;
    /* Ensure buttons are visible and properly styled */
    background: rgba(255, 255, 255, 0.9) !important;
    color: #FF69B4 !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    font-size: 48px !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
  }

  /* Fix selected photo z-index - ensure it's above overlay */
  body .film-frame.selected.loaded,
  body .film-frame.selected,
  .film-frame.selected {
    z-index: 999999 !important;
    /* Ensure selected photo is above any overlays including the dark background */
    position: fixed !important;
  }

  /* Ensure the dark overlay doesn't cover the selected photo */
  .film-strip-container.has-selected::before {
    z-index: 9990 !important;
    /* Keep overlay below selected photo */
  }

  /* Ensure photo action buttons are above selected photo */
  .photo-action-buttons {
    z-index: 999999 !important;
  }

  /* Ensure navigation buttons are above selected photo */
  .photo-nav-btn {
    z-index: 9999999 !important;
  }

  /* Ensure close button is above selected photo */
  .photo-close-btn {
    z-index: 999999 !important;
  }

  /* PWA-specific optimizations */
  .film-strip-container.pwa-mode {
    /* Remove contain that breaks layout */
    will-change: auto !important;
  }


}
